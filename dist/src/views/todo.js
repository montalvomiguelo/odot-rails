define(["jquery","underscore","backbone","text!templates/todo.html","common"],function(e,t,i,l,s){"use strict";var o=i.View.extend({tagName:"li",events:{"click .toggle":"toggleCompleted","dblclick label":"edit","blur .edit":"close","click .destroy":"clear","keypress .edit":"updateOnEnter","keydown .edit":"revertOnEscape"},initialize:function(){this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"visible",this.toggleVisible)},template:t.template(l),render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this.$el.toggleClass("completed",this.model.get("completed")),this.toggleVisible(),this.$input=this.$(".edit"),this},clear:function(){this.model.destroy()},toggleCompleted:function(){this.model.toggle()},edit:function(){this.$el.addClass("editing"),this.$input.focus()},close:function(){var e=this.$input.val().trim();e?this.model.save({title:e}):this.clear(),this.$el.removeClass("editing")},updateOnEnter:function(e){e.keyCode===s.ENTER_KEY&&this.close()},revertOnEscape:function(e){e.keyCode===s.ESCAPE_KEY&&(this.$el.removeClass("editing"),this.$input.val(this.model.get("title")))},toggleVisible:function(){this.$el.toggleClass("hidden",this.isHidden())},isHidden:function(){var e=this.model.get("completed");return!e&&"completed"===s.TodoFilter||e&&"active"===s.TodoFilter}});return o});